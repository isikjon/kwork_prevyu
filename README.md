# Telegram Preview Generator Bot

Автоматизация создания превью изображений через Telegram бота с **прямым редактированием** PSD файлов в Adobe Photoshop.

## Структура проекта

```
kw_tg/
├── design/              # Дизайн-файлы
│   ├── Rust.psd        # ⚠️ Добавить отдельно (237MB)
│   ├── a_machinaorto_bold.ttf
│   └── a_machinaorto.ttf
├── utils/              # Python модули
│   ├── text_processor.py
│   └── psd_processor.py
├── bot.py              # Основной файл бота
├── config.py           # Конфигурация
└── requirements.txt    # Зависимости
```

## Требования

⚠️ **КРИТИЧЕСКИ ВАЖНО:**
- **Windows 10/11**
- **Adobe Photoshop** (любая версия с поддержкой COM)
- **Python 3.8+**

## Установка

1. Клонируй репозиторий:
```bash
git clone https://github.com/isikjon/kwork_prevyu.git
cd kwork_prevyu
```

2. Установи зависимости:
```bash
pip install -r requirements.txt
```

3. **Добавь PSD файл:**
   - Скачай `Rust.psd` отдельно (файл слишком большой для GitHub)
   - Помести в папку `design/Rust.psd`
   - Убедись что текстовые слои называются "1", "2", "3"

## Настройка

1. Создай файл `.env` с токеном бота:
```
BOT_TOKEN=your_telegram_bot_token_here
```

2. **Запусти Adobe Photoshop** (должен быть открыт)

## Запуск

```bash
python bot.py
```

## Как работает

1. Бот **напрямую подключается** к Adobe Photoshop через COM API
2. **Открывает** `design/Rust.psd` 
3. **Находит** текстовые слои: "1", "2", "3"
4. **Автоматически сортирует** слои по Y-позиции (сверху вниз)
5. **Заменяет** содержимое слоев на пользовательский текст
6. **Динамически скрывает** неиспользуемые слои
7. **Экспортирует** изображение с оптимизацией памяти
8. **Восстанавливает** исходное состояние документа

## Использование

1. Отправь `/start` боту
2. Отправь текст (максимум 6 слов)
3. Получи готовое превью с **настоящим редактированием** в Photoshop

Текст автоматически разбивается на строки по 2 слова каждая.
Используется оригинальный шрифт и стили из PSD файла.
Неиспользуемые слои автоматически скрываются.

## Деплой

Для продакшена рекомендуется:
- **Windows VPS** с установленным Photoshop
- Загрузка PSD файла через отдельный канал
- Настройка автозапуска бота
